<!DOCTYPE html>
<html lang="en">
<head>
	<title></title>
	<meta charset="UTF-8">
	<script type="text/javascript" src="/usr/lib/tuquito/tuquito-software-manager/data/templates/jquery.js"></script>
	<script type="text/javascript">
	document.onmousedown = new Function("return false");
	document.onselectstart = new Function ("return false");
	if (window.sidebar) {
	   document.onmousedown = new Function("return false");
	   document.onclick = new Function("return true");
	}

	function changeTitle(title) {
		document.title = title;
		document.title = "nop";
	}

	function addCategory(name, num_packages, img) {
		$("ul").append('<li id="Category_'+ parseInt(categoryCount)+'" cant="'+num_packages+'" name="'+name+'"><img src="'+img+'"></li>');
		categoryCount += 1;
	}

	function animateItems() {
		$("img").css({height: '42', width: '42', margin: 24});
		$("li").mouseenter(function() {
			var name = $(this).attr("name");
			var cant = $(this).attr("cant");
			$("footer span").html("<b>"+name+"</b> | " + cant).fadeIn()
			$("footer").fadeIn(250).width('auto');
			$(this).find("img").animate({height: '66', width: '66', margin: 12}, 120);
		}).mouseleave(function(){
			$(this).find("img").animate({height: '42', width: '42', margin: 24}, 250);
			var width = $("footer").width();
			$("footer span").fadeOut().remove();
			$("footer").width(width)
				.append("<span style='display: none;'>$select</span>")
				.width('auto')
				.children()
				.fadeIn();
		});

		$("li").click(function(){
			var name = $(this).attr("name");
			changeTitle("call:on_category_clicked:"+name);
		}).keydown(function() {
			var name = $(this).attr("name");
			if (event.which == 13)
				changeTitle("call:on_category_clicked:"+name);
		});
	}

	function clearCategories() {
		$("li").remove();
	}

	function currently_displayed_rows() {
		var cat_inc_count = 1, current_offset_left = 0, check_offset_left;
		while (true) {
			check_offset_left = document.getElementById("Category_" + cat_inc_count).offsetLeft;
			if (check_offset_left < current_offset_left) {
				break;
			} else {
				current_offset_left = check_offset_left;
				cat_inc_count += 1;
			}
		}
		return cat_inc_count;
	}

	function onKey(ev) {
		if (ev) {
			switch (ev.keyCode) {
				// left
				case 37:
					category_delta = -1;
					break;
				// up
				case 38:
					category_delta = -currently_displayed_rows();
					break;
				// right
				case 39:
					category_delta = 1;
					break;
				// down
				case 40:
					category_delta = currently_displayed_rows();
					break;
				// tab
				case 9:
					category_delta = 1;
					break;
				default:
					category_delta = 0;
			}

			// HACK: the very first key-stroke should always focus the first element
			if (currentCategory  == -1)
				category_delta = 1;

			// ensure that we go not over the borders
			if ((currentCategory + category_delta) > categoryCount || (currentCategory + category_delta) < 0)
				category_delta = 0;

			var potential_new_category = "Category_" + (parseInt(currentCategory) + category_delta);
			var potential_selected = document.getElementById(potential_new_category);
			if (potential_selected) {
				currentCategory += category_delta;
				potential_selected.focus();
			}
		}
	}
	// global variables to keep track of the cursor
	var categoryCount = 0;
	var currentCategory = -1;
	// global key handler for the arrow keys
	document.onkeyup = onKey;
	</script>
<style type="text/css">
* { -khtml-user-drag: none; }
html {
	background: url('/usr/lib/tuquito/tuquito-software-manager/data/bg.png') repeat-x top;
	font-family: "Ubuntu", Lucida Sans Unicode, Arial, Helvetica, Sans-Serif;
	height: 100%;
	color: #4B4B4B;
	padding: 0;
	margin: 0;
	text-shadow: white 1px 1px 0px;
	overflow: hidden;
}

body {
	background: url('/usr/lib/tuquito/tuquito-software-manager/data/clouds.png') top right no-repeat;
	height: 90%;
	margin: 0;
	padding-top: 50px;
}

ul#grid { margin: 0 auto 0 auto; }

ul#grid li:hover, ul#grid li:focus  { cursor: pointer; }

ul#grid li {
	display: inline-block;
	list-style: none outside;
	float: left;
	padding: 0;
	margin-right: 20px;
	margin-bottom: 20px;
	text-align: center !important;
	height: 90px;
	width: 90px;
}

footer {
	border-radius: 6px;
	color: #fff;
	position: absolute;
	left: 4px;
	bottom: 4px;
	height: 20px;
	padding: 6px 20px;
	background: #000;
	opacity: 0.75;
	text-shadow: none;
	font-size: 15px;
}
</style>
</head>
<body>
	<ul id="grid"></ul>
	<footer><span>$select</span></footer>
</body>
</html>
