<!DOCTYPE html>
<html lang="en">
<head>
	<title></title>
	<meta charset="UTF-8">
	<script type="text/javascript">
	document.onmousedown = new Function("return false");
	document.onselectstart = new Function ("return false");
	if (window.sidebar) {
	   document.onmousedown = new Function("return false");
	   document.onclick = new Function("return true");
	}

	function changeTitle(title) {
		document.title = title;
		document.title = "nop";
	}

	function addCategory(name, num_packages, img) {
		oT = document.getElementsByTagName("table")[0];
		Tr = document.getElementsByTagName("tr")[0];
		newTd = document.createElement("td");
		newTd.setAttribute("tabindex", 0)
		newTd.className = "category_td";
		// we need a <p> around the img so that we can align it
		newTextAroundImg = document.createElement("div");
		newImg = document.createElement("img");
		newImg.src = img;
		newImg.setAttribute("width", 42);
		newImg.setAttribute("height", 42);
		newTextAroundImg.appendChild(newImg);
		newText = document.createElement("div");
		newText.align = "center";

		newSubText = document.createElement("font");
		newSubText.align = "center";
		newSubText.setAttribute("size", 1);
		newSubText.setAttribute("color", "#555555");
		//newSubText2 = document.createElement("b");
		//newSubText.appendChild(document.createTextNode(num_packages))
		//  newSubText.appendChild(newSubText2)

		click_cb = 'changeTitle("call:on_category_clicked:' + name + '");';
		newTd.setAttribute('onclick', click_cb);
		key_cb = 'if (event.which == 13) { changeTitle("call:on_category_clicked:' + name + '"); };'
		newTd.setAttribute('onkeydown', key_cb);
		newTd.id = "Category_"+ parseInt(categoryCount)
		newText.appendChild(document.createTextNode(name))
		newText.appendChild(document.createElement("br"))
		newText.appendChild(newSubText)
		newTd.appendChild(newTextAroundImg);
		newTd.appendChild(newText);
		Tr.appendChild(newTd);
		categoryCount += 1;
	}

	function clearCategories() {
		var row = document.getElementsByTagName("tr")[0];
		for(var i = row.cells.length - 1; i >= 0; i--) {
			row.deleteCell(i);
		}
	}

	function currently_displayed_rows() {
		var cat_inc_count = 1, current_offset_left = 0, check_offset_left;
		while (true) {
			check_offset_left = document.getElementById("Category_" + cat_inc_count).offsetLeft;
			if (check_offset_left < current_offset_left) {
				break;
			} else {
				current_offset_left = check_offset_left;
				cat_inc_count += 1;
			}
		}
		return cat_inc_count;
	}

	function onKey(ev) {
		if (ev) {
			switch (ev.keyCode) {
				// left
				case 37:
					category_delta = -1;
					break;
				// up
				case 38:
					category_delta = -currently_displayed_rows();
					break;
				// right
				case 39:
					category_delta = 1;
					break;
				// down
				case 40:
					category_delta = currently_displayed_rows();
					break;
				// tab
				case 9:
					category_delta = 1;
					break;
				default:
					category_delta = 0;
			}

			// HACK: the very first key-stroke should always focus the first element
			if (currentCategory  == -1)
				category_delta = 1;

			// ensure that we go not over the borders
			if ((currentCategory + category_delta) > categoryCount || (currentCategory + category_delta) < 0)
				category_delta = 0;

			var potential_new_category = "Category_" + (parseInt(currentCategory) + category_delta);
			var potential_selected = document.getElementById(potential_new_category);
			if (potential_selected) {
				currentCategory += category_delta;
				potential_selected.focus();
			}
		}
	}

	// global variables to keep track of the cursor
	var categoryCount = 0;
	var currentCategory = -1;
	// global key handler for the arrow keys
	document.onkeyup = onKey;
	</script>

<style type="text/css">
html {
	background: url('/usr/lib/tuquito/tuquito-software-manager/data/bg.png') repeat-x top;
	font-family: "Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, Sans-Serif;
	height: 100%;
	color: #4B4B4B;
	padding: 0;
	margin: 0;
}

body { background: url('/usr/lib/tuquito/tuquito-software-manager/data/clouds.png') top right no-repeat; }

#categoriesTable {
	padding-left: 60px;
	padding-top: 30px;
}

.category_td {
	margin: 0 10px 10px 13px;
	padding: 8px;
	float: left;
	vertical-align: top;
	text-overflow: ellipsis;
	display: inline-block;
	height: 90px;
	width: 7em !important;
	opacity: 0.7;
}

.category_td:hover, .category_td:focus  {
	cursor: pointer;
	opacity: 1;
}

.category_td p { font-size: 90%; text-align: center; }
.category_td div { font-size: 90%; text-align: center; }

/* make images not draggable in the categories view */
img { -khtml-user-drag: none; }
</style>
</head>
<body>
  <div id="departments">
    <table id="categoriesTable">
      <tr></tr>
    </table>
  </div>
</body>
<body>
</html>
